{% extends "layout.html" %}

{% block results %}

  <main id="main">
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load("current", {packages:["corechart"]});
      google.charts.setOnLoadCallback(drawCharts);

      function drawCharts() {
        // First Pie Chart
        var data1 = google.visualization.arrayToDataTable([
          ['School', 'Number of Students'],
          ['Gabriel Pereira ', 281],
          ['Mousinho da Silveira', 114],
        ]);

        var options1 = {
          pieHole: 0.4,
          colors: ['#2f4858', '#86bbd8'],
          pieSliceText: 'none',
        };

        var chart1 = new google.visualization.PieChart(document.getElementById('chart1'));
        chart1.draw(data1, options1);

        // Second Pie Chart
        var data2 = google.visualization.arrayToDataTable([
          ['Age', 'Count'],
          ['15', 82],
          ['16', 104],
          ['17', 98],
          ['18', 82],
          ['19', 24],
          ['20', 3],
          ['21', 1],
          ['22', 1]
        ]);

        var options2 = {
          pieHole: 0.4,
          colors: ['#a4243b', '#d8c99b', "#d8973c", "#bd632f", "068DA9", "7E1717", "E55807", "2CD3E1"],
          pieSliceText: 'none',
        };

        var chart2 = new google.visualization.PieChart(document.getElementById('chart2'));
        chart2.draw(data2, options2);

        // Third Pie Chart
        var data3 = google.visualization.arrayToDataTable([
          ['sex', 'Count'],
          ['Females', 208],
          ['Males', 187]
        ]);

        var options3 = {
          pieHole: 0.4,
          colors: ['#273e47', '#bd632f'],
          pieSliceText: 'none',
        };

        var chart3 = new google.visualization.PieChart(document.getElementById('chart3'));
        chart3.draw(data3, options3);
      }
    </script>

  <script type="text/javascript">
  var topka = new Map([
    {% for point in najlepsi %}
      ["{{options[loop.index0]}}", {{ point }}],
    {% endfor %}
  ]);
  var vsetci = new Map([
    {% for point in vsetci %}
    ["{{options[loop.index0]}}", {{ point }}],
  {% endfor %}
  ]);
  var worst0 = new Map([
    {% for point in najhorsi_0 %}
    ["{{options[loop.index0]}}", {{ point }}],
  {% endfor %}
  ]);
  var worst = new Map([
   {% for point in najhorsi_nie_0 %}
    ["{{options[loop.index0]}}", {{ point }}],
  {% endfor %}
  ]);
    google.charts.load('current', { 'packages': ['corechart'] });

    function generateChart() {
     var selectedValue = document.getElementById("selectOption").value;
    var topValue = topka.get(selectedValue);
    var allValue = vsetci.get(selectedValue);
    var worst0Value = worst0.get(selectedValue);
    var worstValue = worst.get(selectedValue);
      var data = google.visualization.arrayToDataTable([
        ['Group', 'Mean', { role: 'style' }],
        ['Students with more than 17 points from G3', topValue, '#003049'],
        ['All students', allValue, '#f77f00'],
        ['Students with 0 points from G3', worst0Value, '#fcbf49'],
        ['Worst students from G3 (zero excluded)', worstValue, '#eae2b7']
      ]);
    
      var view = new google.visualization.DataView(data);
      view.setColumns([0, 1, {
        calc: 'stringify',
        sourceColumn: 1,
        type: 'string',
        role: 'annotation'
      }, 2]);

      var options = {
        title: 'Means of a given variable in the specific groups',
        width: 600,
        height: 400,
        bar: { groupWidth: '95%' },
        legend: { position: 'none' },
      };

      var chart = new google.visualization.BarChart(document.getElementById('barchart_values'));
      chart.draw(view, options);
    }
    google.charts.setOnLoadCallback(generateChart);
    </script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load("current", { packages: ["corechart"] });
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    var pointsData = [['Points', 'Count']];
    var pointMap = new Map([
      {% for point in points %}
        [{{ point[0] }}, {{ point[1] }}],
      {% endfor %}
    ]);

    for (var i = 0; i <= 20; i++) {
      var count = pointMap.has(i) ? pointMap.get(i) : 0;
      pointsData.push([i, count]);
    }

    var data = google.visualization.arrayToDataTable(pointsData);

    var options = {
      title: 'Distribution of the different grades in the G3 test',
      legend: { position: 'none' },
      viewWindow: {
          min: -1,
          max: 20.5
        },
      hAxis: {
        title: 'Points',
      },
      vAxis: {
        title: 'Count',
      }
    };

    var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }
</script>


  <!-- ======= Breadcrumbs Section ======= -->
  <section class="breadcrumbs">
    <div class="container">

      <div class="d-flex justify-content-between align-items-center">
        <h2>Our results</h2>
        <ol>
          <li><a href={{url_for('home')}} >Home</a></li>
          <li>Our results</li>
        </ol>
      </div>


    </div>
  </section><!-- End Breadcrumbs Section -->

  <!-- RESULTS MENU -->
  <section id="services" class="services section-bg">
    <div class="container" data-aos="fade-up">

      <div class="section-title">
        <h2>Results</h2>
        <p>Our visualisation and analysis</p>
      </div>
      <div class="row">
        <div class="col-md-6 col-lg-3 d-flex align-items-stretch" data-aos="zoom-in" data-aos-delay="100">
          <a href="#result1">
          <div class="icon-box">
            <div class="icon"><i class="bx bx-question-mark"></i></div>
            <h4 class="title"><a href="">Women are dumb</a></h4>
            <p class="description">As has always been said by the wisest, by God himself blessed gender - male - they do belong in the kitchen</p>
            </div>
          </div>
          </a>
          <div class="col-md-6 col-lg-3 d-flex align-items-stretch" data-aos="zoom-in" data-aos-delay="200">
            <a href="#result2">
            <div class="icon-box">
              <div class="icon"><i class="bx bx-money-withdraw"></i></div>
              <h4 class="title"><a href="">Money heist</a></h4>
              <p class="description">Aint gonna help you make your kids grades higher - sorry m8, genetics is genetics</p>
            </div>
          </a>
          </div>

          <div class="col-md-6 col-lg-3 d-flex align-items-stretch" data-aos="zoom-in" data-aos-delay="300">
            <a href="#result3">
            <div class="icon-box">
              <div class="icon"><i class="bx bx-drink"></i></div>
              <h4 class="title"><a href="">Alcoholics stay alocoholics</a></h4>
              <p class="description">After a thorough inspection we figured out that people that drink during the weekend also drink during the workdays - maybe thats why the money aint helping</p>
            </div>
          </a>
          </div>
          <div class="col-md-6 col-lg-3 d-flex align-items-stretch" data-aos="zoom-in" data-aos-delay="400">
            <a href="#result4">
            <div class="icon-box">
              <div class="icon"><i class="bx bxs-hot"></i></div>
              <h4 class="title"><a href="">Smart chicks are just hot</a></h4>
              <p class="description">Looks like our male audience likes to make a selection based on the academical results of the potential mating partner</p>
            </div>
          </a>
      
          </div>
      </div>


    </div>
  </section><!-- End RESULTS MENU -->

  <!-- CHOOSING THE DATASET -->
  <section id="result1" class="about">
    <div class="container">

      <div class="row justify-content-between">
        <div class="col-lg-5 d-flex align-items-center justify-content-center about-img">
          <img src={{url_for('static', filename="assets/img/about-img.svg" )}} class="img-fluid" alt="" data-aos="zoom-in">
        </div>
        <div class="col-lg-6 pt-5 pt-lg-0">
          <h3 data-aos="fade-up">Choosing the dataset</h3>
          <p data-aos="fade-up" data-aos-delay="100">
            At that time we had no idea about satans' contribution to the dataset because it turned out to be an absolute hell.
          </p>
          <div class="row">
            <div class="col-md-6" data-aos="fade-up" data-aos-delay="100">
              <i class="bx bx-receipt"></i>
              <h4>Nothing works</h4>
              <p>There is like literally 0 things that run smoothly in this dataset</p>
            </div>
            <div class="col-md-6" data-aos="fade-up" data-aos-delay="200">
              <i class="bx bx-cube-alt"></i>
              <h4>It might be just us being dummy</h4>
              <p>But let's blame our educational system for that</p>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </section>
  <!-- END CHOOSING THE DATASET -->

  <!-- CATEGORIES AND THEIR STATISTICS-->
  <section id="result2" class="services section-bg">
    <div class="container" data-aos="fade-up">

      <div class="section-title">
        <h2>Database</h2>
        <p>Categories and general information</p>
      </div>
      <div class="row"> 
        <p>
          {% for j in range((info_cat|length/6)|int + 1) %}
            <div class="row justify-content-center" data-aos="fade-up">
              {% for i in range(1,7) if not (6*j + i > info_cat|length) %}
              <div class="col-2 mb-2">
                  <button type="button" class="btn btn-orange col-12" data-html='true'  data-toggle="popover" title="Statistics" data-content='<table class="table">
                    <thead>
                      <tr>
                        <th scope="col"></th>
                        <th scope="col">{{info_cat[6*j+i-1][1]}}</th>
                        <th scope="col">{{info_cat[6*j+i-1][2]}}</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th scope="row">Estimate</th>
                        <td>{{info_cat[6*j+i-1][3]}}</td>
                        <td>{{info_cat[6*j+i-1][4]}}</td>
                      </tr>
                      <tr>
                        <th scope="row">Statistic</th>
                        <td colspan="2" class="text-center">{{info_cat[6*j+i-1][5]}}</td>
                      </tr>
                      <tr>
                        <th scope="row">P-value</th>
                        <td colspan="2" class="text-center">{{info_cat[6*j+i-1][6]}}</td>
                      </tr>
                    </tbody>
                  </table>'>
                  {{info_cat[6*j+i-1][0]}}
                </button>

              </div>
              {% endfor %}

            </div>
          {% endfor %}
        </p>
      
      </div>
    </div>
  </section>
  <!-- END CATEGORIES AND THEIR STATISTICS-->


  <!-- GENERAL STATISTICS-->
  <section id="result3" class="services ">
    <div class="container">

      <div class="row justify-content-center">
        <div class="col-lg-12 pt-5 pt-lg-0 text-center">
          <div class="section-title ">
            <h2>Results</h2>
            <p>Some general statistics</p>
            
          </div>
          <div class="row about team py-0">
           
            <div class="col-6 justify-content-center" data-aos="fade-up" data-aos-delay="200">
              <i class='bx bx-analyse' style="position: relative;z-index: 1;"></i>
              <h4 style="position: relative;z-index: 1;">Distribution of marks</h4>
              <p style="font-size: .9em ;position: relative;z-index: 1;">Appears to be normal (except for the 0 points)</p>
              <div id="chart_div" class="col-12" style="width: 1100px; height: 500px; margin-top:-60px;"  data-aos="zoom-in"></div>
            </div>

            <div class="col-6 justify-content-center" data-aos="fade-up" data-aos-delay="200">
              <i class='bx bxs-school'style="position: relative;z-index: 1;"></i>
              <h4 style="position: relative;z-index: 1;">Proportion of students from each of the schools</h4>
              <p style="font-size: .9em ;position: relative;z-index: 1;">It can be seen that Gabriela Pereira school has a greater proportion of students, so this property is not distinctive</p>

              <div id="chart1" class="chart col-12" style="width: 1100px; height: 500px; margin-top:-80px;"  data-aos="zoom-in"></div>
            </div>
          </div>

          <div class="row about team py-0">
           
            <div class="col-6 justify-content-center" data-aos="fade-up" data-aos-delay="200">
              <i class='bx bx-body' style="position: relative;z-index: 1;"></i>
              <h4 style="position: relative;z-index: 1;">Age Distribution</h4>
              <p style="font-size: .9em ;position: relative;z-index: 1;">The greatest part of the dataset are students of age 15-18 which are distributed almost uniformly. Pupils who are 19 years or older represent only a small portion, so the dataset is focused mainly on high school students.</p>

              <div id="chart2" class="chart col-12" style="width: 1100px; height: 500px; margin-top:-50px; "  data-aos="zoom-in"></div>
            </div>

            <div class="col-6 justify-content-center" data-aos="fade-up" data-aos-delay="200">
              <i class='bx bx-female-sign' style="position: relative;z-index: 1;"></i>
              <h4 style="position: relative;z-index: 1;">Sex distribution</h4>
              <p style="font-size: .9em ;position: relative;z-index: 1;">The proportion of women is a bit bigger but we can say that the proportion is balanced.</p>

              <div id="chart3" class="chart col-12" style="width: 1100px; height: 500px;  margin-top:-50px;"  data-aos="zoom-in"></div>
            </div>
          </div>
         
        </div>
      </div>

    </div>
  </section>
  <!-- END GENERAL STATISTICS -->

  <!-- UNFINISHED -->
  <section id="result2" class="about section-bg">
    <div class="container">

      <div class="row justify-content-between">
        <div class="col-lg-6 pt-5 pt-lg-0">
          <h3 data-aos="fade-up">There might be something fishy going on</h3>
          <p data-aos="fade-up" data-aos-delay="100">
            And when he had finished speaking, he said to Simon, “Put out into the deep and let down your nets for a catch.”
          </p>
          <div class="row">
            <div class="col-md-6" data-aos="fade-up" data-aos-delay="100">
              <i class="bx bx-receipt"></i>
              <h4>Just keep swimming</h4>
              <p>There is like literally 0 things that run smoothly in this dataset</p>
            </div>
            <div class="col-md-6" data-aos="fade-up" data-aos-delay="200">
              <i class="bx bx-cube-alt"></i>
              <h4>Haven't found a good regression let alone Nemo</h4>
              <p>But let's blame our educational system for that</p>
            </div>
          </div>
        </div>
        <div class="col-lg-5 d-flex align-items-center justify-content-center about-img">
          <img src={{url_for('static', filename="assets/img/fis.png" )}} class="img-fluid" alt="" data-aos="zoom-in">
        </div>
      </div>
      <div>
    <select id="selectOption" onchange="generateChart()">
      <option value="Medu">Mother's education | 0 worst - 4 best</option>
      <option value="Fedu">Father's education | 0 worst - 4 best</option>
      <option value="traveltime">Traveltime | 1 shortest - 4 longest</option>
      <option value="studytime">Studytime | 1 shortest - 4 longest</option>
      <option value="failures">Past failures | 0 to 3</option>
      <option value="schoolsup">Extra educational support | FALSE/TRUE</option>
      <option value="famsup">Family educational support | FALSE/TRUE</option>
      <option value="paid">Paid lessons | FALSE/TRUE</option>
      <option value="activities"> Extra-curricular activities | FALSE/TRUE</option>
      <option value="nursery">Attended nursery | FALSE/TRUE</option>
      <option value="higher">Ambitions to take higher education | FALSE/TRUE</option>
      <option value="internet">Internet access at home | FALSE/TRUE</option>
      <option value="romantic">In a relationship | FALSE/TRUE</option>
      <option value="famrel">Quality of family relationships | 1 worst - 5 best</option>
      <option value="freetime">Freetime | 1 very low - 5 very high</option>
      <option value="goout">Going out with friends | 1 very low - 5 very high</option>
      <option value="Dalc">Workday alcohol consumption | 1 very low - 5 very high</option>
      <option value="Walc">Weekend alcohol consumption | 1 very low - 5 very high</option>
      <option value="health">Current health status | 1 worst - 5 best</option>
      <option value="absences">Number of school absences| 0 to 93</option>
      <option value="G1">G1 score | 0 to 20</option>
      <option value="G2">G2 score | 0 to 20</option>
    </select>
  </div>
      <div id="barchart_values" style="width: 900px; height: 300px;"></div>
    </div>
  </section>
  <!-- END UNFINISHED-->

  <!-- WHAT MAKES YOU SUCCESSFUL-->
  <section id="result4" class="about">

    <div class="container">

      <div class="row justify-content-between ">
        <div class="col-lg-5 d-flex align-items-center justify-content-center about-img ms-5 pe-0">
          <img src={{url_for('static', filename="assets/img/success.png" )}} class="img-fluid" style="margin-top:-100px;position:relative; z-index: 1; " alt="" data-aos="zoom-in">
        </div>

      
        <div class="col-lg-6 ps-5 pt-3 my-auto">
          <h3 data-aos="fade-up">Oh-oh, that's what makes you succesful!</h3>
          <p data-aos="fade-up" data-aos-delay="100">
            Ever wondered if it is just in your blood that you are stupid like a bagandža? Don't worry, we took a closer look 
            at those portugese students and found that it is just your lazy ass that just cannot stop scrolling on IG.
          </p>
        </div>
        <div class="row about team mt-4 pt-0 text-center justify-content-center">
          <div class="col-6  justify-content-center" data-aos="fade-up" data-aos-delay="100">
            <i class='bx bx-brain' ></i>
            <h4>Parents' education impact</h4>
            <div class="member">
              <img src={{url_for('static', filename="assets/graphs/parents_education.png" )}} class="img-fluid"  style="width: 775px; height: 500px;" >
              <div class="member-info">
                <div class="member-info-content text-right  pe-2">
                  <h4>Impact of parent's education on academical results</h4>
                  <span>Whatever that line is supposed to mean it's going up so i guess its good</span>
                </div>
              </div>
            </div>
          </div>

          <div class="col-6 justify-content-center" data-aos="fade-up" data-aos-delay="100">
            <i class='bx bx-home' ></i>
            <h4>Family size impact</h4>
            <div class="member">
              <img src={{url_for('static', filename="assets/graphs/sizeOfFamily.png" )}} class="img-fluid"  style="width:600px; height: 500px;">
              <div class="member-info">
                <div class="member-info-content text-right pe-2">
                  <h4>Impact on family size on academical results</h4>
                  <span>Does not matter</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row about team pt-0 text-center justify-content-center">
          <div class="col-6" data-aos="fade-up" data-aos-delay="100">
            <i class='bx bx-male-female'></i>
            <h4>Girls vs Boys</h4>
            <div class="member ">
              <img src={{url_for('static', filename="assets/graphs/boysVSgirls.png" )}} class="img-fluid " style="width: 550px; height: 375px;" >
              <div class="member-info">
                <div class="member-info-content text-right  pe-2">
                  <h4>Comparison of results based on gender</h4>
                  <span>Male students seem to have slightly better results than female students</span>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
      
    </div>
  </section>
  <!-- END WHAT MAKES YOU SUCCESSFUL-->

 <!-- HYPOTHESES -->
  <section id="result4" class="services section-bg">
    <div class="container">
      <div class="row justify-content-center about">
        <div class="col-lg-6 ps-5 pt-5 pb-0 mb-0">
          <h3 data-aos="fade-up">Now it's gonna get all hypothetical</h3>
          <p data-aos="fade-up" data-aos-delay="100">
            We bet you already got many hypotheses on your mind after reading all this. Want to compare certain groups in our database? Of course you can!
          </p>
        </div>
        <div class="col-lg-6 about-img ">
          <img src={{url_for('static', filename="assets/img/hypoth.png" )}} class="img-fluid d-flex mx-auto" style="height:60%; " alt="" data-aos="zoom-in">
        </div>
      </div>
      <div class="row justify-content-center" style="margin-top: -200px;">
        <div class="section-title" data-aos="zoom-in">
          <p style="color:#eb5d1e">Test your hypothesis!</p>
        </div>
        <div class="col-12 d-flex justify-content-center" data-aos="fade-up" data-aos-delay="100">
          <p class="my-auto">In category</p>
          <div class="dropup show ps-1">
            <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="cat" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></a>
          
            <div class="dropdown-menu" style="position:relative; z-index:1;" aria-labelledby="cat">
              {% for cat in info_cat %}
              <a class="dropdown-item" onclick="updateResult('cat',this)" >{{cat[0]}}</a>
              {% endfor %}
            </div>
          </div>
          <p class="my-auto">, is</p>
            <a class="btn btn-secondary text-light" role="button" id="g1" disabled></a>
          <p class="my-auto">better than</p>
            <a class="btn btn-secondary text-light" role="button" id="g2" disabled></a>
          <p class="my-auto pb-1">?</p>
        </div>
        <div id="result" class="col-12 pt-3 text-center"></div>
      </div>
      
    </div>
  </section>
  <!-- END HYPOTHESIS -->




  <!-- CORRELATION -->
  <section id="result4" class="services ">

    <div class="container">
      <div class="section-title ">
        <h2>Regression</h2>
        <p>Correlation matrix</p>
      
      </div>
      <div class="row justify-content-between about ">
        <div class="col-lg-5 d-flex align-items-center justify-content-center about-img ms-5 pe-0">
          <img src={{url_for('static', filename="assets/graphs/maticka.png" )}} class="img-fluid"  alt="" data-aos="zoom-in">
        </div>

      
        <div class="col-lg-6 ps-5 pt-3 my-auto">
          <h3 data-aos="fade-up">Choosing appropriate categories for logistic regression</h3>
          <p data-aos="fade-up" data-aos-delay="100">
            Think twice, cut once - said one famous director. So we also took a look at correlation between each pair of categories, 
            so that our awesome regression looks even sexier - it can be seen that the grades would have greatest impact and also some other 
            pointers. Whatever, it worked.
          </p>
          <div class="row">
            <div class="col-6" data-aos="fade-up" data-aos-delay="100">
              <i class='bx bxs-book' ></i>
              <h4>Grades do make an impact</h4>
              <p>No idea how that makes sense</p>
            </div>
            <div class="col-6" data-aos="fade-up" data-aos-delay="200">
              <i class='bx bx-x'></i>
              <h4>Failures</h4>
              <p>have rather negative correlation which does impact the grades in an expected way</p>
            </div>
          </div>
        </div>
        
      </div>
      <div class="row about mt-4">
        <h3 style="color: grey;" data-aos="fade-up">Some irrelevant (but still interesting) correlations</h3>
        <div class="col-6" data-aos="fade-up" data-aos-delay="100">
          <i class='bx bx-happy-heart-eyes' ></i>
          <h4>Smart marriage</h4>
          <p>There is a correlation that implies man with higher education also tend to marry women at similar knowledge level</p>
        </div>
        <div class="col-6" data-aos="fade-up" data-aos-delay="200">
          <i class='bx bxs-drink' ></i>
          <h4>Alcoholics stay alcoholics</h4>
          <p>Students with higher alcohol consumption during weekdays also have a tendency to drink during the weekend. Also students that
            got are more prone to drinking alcohol.
          </p>
        </div>
      </div>
      
    </div>
  </section>
  <!-- END CORRELATION -->

  <!-- 3D REGRESION -->
  <section id="result4" class="about section-bg">

    <div class="container">

      <div class="row justify-content-between">


        <div class=" col-lg-4 d-flex align-items-center justify-content-center about-img" data-aos="zoom-in">
          <div id="chart" class="chart "></div>
        </div>
        <div class="col-lg-6 ps-5 pt-3 ">
          <h3 data-aos="fade-up">Oh-oh, that's what makes you succesful!</h3>
          <p data-aos="fade-up" data-aos-delay="100">
            How various categories impact students' results and overall academical work
          </p>
          <div class="row">
            <div class="col-md-6" data-aos="fade-up" data-aos-delay="100">
              <i class="bx bx-receipt"></i>
              <h4>Unless you watch fimls illegaly</h4>
              <p>But those should be out of your range of interest</p>
            </div>
            <div class="col-md-6" data-aos="fade-up" data-aos-delay="200">
              <i class="bx bx-cube-alt"></i>
              <h4>Ask the mirror on the wall</h4>
              <p>whether you can fuck with them all</p>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </section>
  <!-- END 3D REGRESION -->


    

  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script type="text/javascript">

      $(function () {
          $('[data-toggle="popover"]').popover({
              html: true,
              sanitize: false,
          });
      });
    var graphs = {{graphJSON | safe}};
    Plotly.plot('chart',graphs,{});        
  </script>

  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load("current", { packages: ["corechart"] });
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
      var pointsData = [['Points', 'Count']];
      var pointMap = new Map([
        {% for point in points %}
          [{{ point[0] }}, {{ point[1] }}],
        {% endfor %}
      ]);

      for (var i = 0; i <= 20; i++) {
        var count = pointMap.has(i) ? pointMap.get(i) : 0;
        pointsData.push([i, count]);
      }

      var data = google.visualization.arrayToDataTable(pointsData);

      var options = {
        legend: { position: 'none' },
        viewWindow: {
            min: -1,
            max: 20.5
          },
        hAxis: {
          title: 'Points',
          baselineColor: 'none',
          // ticks: []
        },
        vAxis: {
          title: 'Count',

        }
      };

      var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
      chart.draw(data, options);
    }
  </script>

<script>
  // Array with results
  var results = {
    {% for pr in info_cat %}
    "{{pr[0]|safe}}":["{{pr[1]}}", "{{pr[2]}}", {{pr[3]}}, {{pr[4]}}, {{pr[6]}}],
    {% endfor %}
  };

  function showResult() {
      // Get the selected values from the dropdown menus
      var cat = document.getElementById("cat");
      var g1 = document.getElementById("g1");
      var g2 = document.getElementById("g2");

      // Create the key to access the result in the results array
      var key = cat.text;
      var g1name = results[key][0];
      var g2name = results[key][1];

      g1.text = g1name;
      g2.text = g2name;

      var g1avg = results[key][2];
      var g2avg = results[key][3];
      var pval = results[key][4];
      var result = "";
      if(Math.abs(pval) < .05){
        result = `<h3><b>Yes!</b> The <b>p-value ${pval}</b> is significant.</h3> <br>Additionally, the average in the group <b>"${g1name}"</b> the average value is <b>${g1avg}</b>, whereas in the second group
        <b>"${g2name}"</b> the average is <b>${g2avg}</b>.`;
        g1.className = "";
        g1.className = "";
        g2.className = "";
        cat.className = "";
        cat.classList.add("btn");
        cat.classList.add("btn-success");
        cat.classList.add("dropdown-toggle");

        g1.classList.add("btn");
        g1.classList.add("btn-success");
        g2.classList.add("btn");
        g2.classList.add("btn-success");
        document.getElementById("result").className = "";
        document.getElementById("result").classList.add("mt-2");
        document.getElementById("result").classList.add("py-2");


        document.getElementById("result").classList.add("rounded");

        document.getElementById("result").classList.add("border"); 
        document.getElementById("result").classList.add("border-success");
        document.getElementById("result").classList.add("text-success");
        document.getElementById("result").classList.add("text-center");


      }
      else{
        result = `<h3><b>No!</b> The <b>p-value ${pval}</b> is not considered significant.</h3> <br>Additionally, the average in the group <b>"${g1name}"</b> the average value is <b>${g1avg}</b>, whereas in the second group
        <b>"${g2name}"</b> the average is <b>${g2avg}</b>.`;
        g1.className = "";
        g2.className = "";
        cat.className = "";
        cat.classList.add("btn");
        cat.classList.add("btn-danger");
        cat.classList.add("dropdown-toggle");
        g1.classList.add("btn");
        g1.classList.add("btn-danger");
        g2.classList.add("btn");
        g2.classList.add("btn-danger");
        document.getElementById("result").className = "";
        document.getElementById("result").classList.add("mt-2");
        document.getElementById("result").classList.add("p-2");


        document.getElementById("result").classList.add("rounded");

        document.getElementById("result").classList.add("border"); 
        document.getElementById("result").classList.add("border-danger");
        document.getElementById("result").classList.add("text-danger");
        document.getElementById("result").classList.add("text-center");

      }

      document.getElementById("result").innerHTML = result;
    }
    
    // Function to update the result automatically when both dropdowns are selected
    function updateResult(w,elem) {
      document.getElementById(w).text = elem.text;
      var cat = document.getElementById("cat");

      if (cat.text !== "") {
        showResult();
      }
    }
</script>
</main><!-- End #main -->
{% endblock %}
